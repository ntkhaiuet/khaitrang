// const listMusic = [
//   "https://dl.dropbox.com/s/triheh29409tb67/Aloha.mp3?dl=0",
//   "https://dl.dropbox.com/s/trd1hgjlyouu16u/AnhDanhRoiNguoiYeuNay.mp3?dl=0",
//   "https://dl.dropbox.com/s/m0mk514x68utcmy/AnhNhoEm.mp3?dl=0",
//   "https://dl.dropbox.com/s/48zt20brgql5wt8/AnhNangCuaAnh.mp3?dl=0",
//   "https://dl.dropbox.com/s/0c53bqw00qw2rmu/AtMyWorst.mp3?dl=0",
//   "https://dl.dropbox.com/s/1detj1wckrt2ye5/BanTinhCaDauTien.mp3?dl=0",
//   "https://dl.dropbox.com/s/ko7aetiimx3vvfk/beautifulInWhite.mp3?dl=0",
//   "https://dl.dropbox.com/s/me6jlcxp3i46wwf/Blank.mp3?dl=0",
//   "https://dl.dropbox.com/s/x4uwfjqfsg46lep/BoEmVaoBalo.mp3?dl=0",
//   "https://dl.dropbox.com/s/m0zz057i578abmi/aChoToiTinhYeu.mp3?dl=0",
//   "https://dl.dropbox.com/s/qbx60eea3g4r0ri/CountingStars.mp3?dl=0",
//   "https://dl.dropbox.com/s/9j6spqgqvg1hsqe/CoHenVoiThanhXuan.mp3?dl=0",
//   "https://dl.dropbox.com/s/7a1mp6ao6cvceta/aEmDayNay.mp3?dl=0",
//   "https://dl.dropbox.com/s/x6mktsot8rbaatx/EverytimeWeTouch.mp3?dl=0",
//   "https://dl.dropbox.com/s/0k98n8mxmuou9mo/GirlsLikeYou.mp3?dl=0",
//   "https://dl.dropbox.com/s/9ta4fbg3nkyaibb/Happy.mp3?dl=0",
//   "https://dl.dropbox.com/s/trmfafnisr1qtq2/HanhPhucCuoiCung.mp3?dl=0",
//   "https://dl.dropbox.com/s/ntu8nbgefws4beb/HeroesTonight.mp3?dl=0",
//   "https://dl.dropbox.com/s/zkvmy4dk6zrj2k1/aHonCaMayTroi.mp3?dl=0",
//   "https://dl.dropbox.com/s/pwrzeijlzvpe03h/iDo.mp3?dl=0",
//   "https://dl.dropbox.com/s/9zz9b0sa98t4djw/Invincible.mp3?dl=0",
//   "https://dl.dropbox.com/s/23jqvgapvnzg67x/KeTheoDuoiAnhSang.mp3?dl=0",
//   "https://dl.dropbox.com/s/sdapnwgcr5y69w5/aKhongCanPhaiHuaDauEm.mp3?dl=0",
//   "https://dl.dropbox.com/s/9p4mqhzqo85yead/aLaAnhDay.mp3?dl=0",
//   "https://dl.dropbox.com/s/zll96zh5ddkdez2/LoveMeLikeYouDo.mp3?dl=0",
//   "https://dl.dropbox.com/s/x5vxqy4rf7r8d8b/MatMoc.mp3?dl=0",
//   "https://dl.dropbox.com/s/z2u867re57xlx6p/Mortals.mp3?dl=0",
//   "https://dl.dropbox.com/s/o07c2vmsagxuwu6/aMuaYeuDau.mp3?dl=0",
//   "https://dl.dropbox.com/s/rer1ix5oc1scd2a/My%20Heart.mp3?dl=0",
//   "https://dl.dropbox.com/s/209w1q9q2o8ym0l/MyLove.mp3?dl=0",
//   "https://dl.dropbox.com/s/mogsjg0sqelj28k/aNgayNangLen.mp3?dl=0",
//   "https://dl.dropbox.com/s/of5zasv3uilzavb/On%26On.mp3?dl=0",
//   "https://dl.dropbox.com/s/vdqbabdog40kxhz/Perfect.mp3?dl=0",
//   "https://dl.dropbox.com/s/jqf6bh8un4xjgme/ProudOfYou.mp3?dl=0",
//   "https://dl.dropbox.com/s/fwt5s82b9deo3w3/SeeYouAgain.mp3?dl=0",
//   "https://dl.dropbox.com/s/vl17y5zuvlvwnlj/SeMaiMotTinhYeu.mp3?dl=0",
//   "https://dl.dropbox.com/s/o9qtdy20t86zbx4/ShapeOfYou.mp3?dl=0",
//   "https://dl.dropbox.com/s/nsmqfcef34fzut0/Shine.mp3?dl=0",
//   "https://dl.dropbox.com/s/pami722can8pbcu/Sky%20High.mp3?dl=0",
//   "https://dl.dropbox.com/s/duxdvzy7nte7k4u/Sugar.mp3?dl=0",
//   "https://dl.dropbox.com/s/wvw9gcbn38pb1c0/SuytNuaThi.mp3?dl=0",
//   "https://dl.dropbox.com/s/0mfww3641k3ngqk/Symbolism.mp3?dl=0",
//   "https://dl.dropbox.com/s/dl5unxogrkm7ah9/TinhYeuMauHong.mp3?dl=0",
//   "https://dl.dropbox.com/s/cioeknqrikyen5y/aTinhYeuTrongMo.mp3?dl=0",
//   "https://dl.dropbox.com/s/tsgchato704iu0d/UntilYou.mp3?dl=0",
//   "https://dl.dropbox.com/s/z0h7dgjxxja3soc/UptownFunk.mp3?dl=0",
//   "https://dl.dropbox.com/s/nsem7aldapcz5fs/WhyNotMe.mp3?dl=0",
//   "https://dl.dropbox.com/s/0tsfhibbqvyfoc6/Why%20We%20Lose.mp3?dl=0",
//   "https://dl.dropbox.com/s/s7nvmq5jo6s73xg/aYeuLaCho.mp3?dl=0",
// ];

// const titleMusic = [
//   "Aloha",
//   "Anh Đánh Rơi Người Yêu Này",
//   "Anh Nhớ Em",
//   "Ánh Nắng Của Anh",
//   "At My Worst",
//   "Bản Tình Ca Đầu Tiên",
//   "Beatiful In White",
//   "Blank",
//   "Bỏ Em Vào Balo",
//   "Cho Tôi Tình Yêu",
//   "Counting Stars",
//   "Có Hẹn Với Thanh Xuân",
//   "Em Đây Này",
//   "Everytime We Touch",
//   "Girls Like You",
//   "Happy",
//   "Hạnh Phúc Cuối Cùng",
//   "Heroes Tonight",
//   "Hơn Cả Mây Trời",
//   "I Do",
//   "Invincible",
//   "Kẻ Theo Đuổi Ánh Sáng",
//   "Không Cần Phải Hứa Đâu Em",
//   "Là Anh Đây",
//   "Love Me Like You Do",
//   "Mặt Mộc",
//   "Mortals",
//   "Mùa Yêu Đầu",
//   "My Heart",
//   "My Love",
//   "Ngày Nắng Lên",
//   "On & On",
//   "Perfect",
//   "Proud Of You",
//   "See You Again",
//   "Sẽ Mãi Một Tình Yêu",
//   "Shape Of You",
//   "Shine",
//   "Sky High",
//   "Sugar",
//   "Suýt Nữa Thì",
//   "Symbolism",
//   "Tình Yêu Màu Hồng",
//   "Tình Yêu Trong Mơ",
//   "Until You",
//   "Uptown Funk",
//   "Why Not Me",
//   "Why We Lose",
//   "Yêu Là Chờ",
// ];

const music = [
  {
    title: "Aloha",
    link: "https://dl.dropbox.com/s/triheh29409tb67/Aloha.mp3?dl=0",
  },
  {
    title: "Anh Đánh Rơi Người Yêu Này",
    link: "https://dl.dropbox.com/s/trd1hgjlyouu16u/AnhDanhRoiNguoiYeuNay.mp3?dl=0",
  },
  {
    title: "Anh Nhớ Em",
    link: "https://dl.dropbox.com/s/m0mk514x68utcmy/AnhNhoEm.mp3?dl=0",
  },
  {
    title: "Ánh Nắng Của Anh",
    link: "https://dl.dropbox.com/s/48zt20brgql5wt8/AnhNangCuaAnh.mp3?dl=0",
  },
  {
    title: "At My Worst",
    link: "https://dl.dropbox.com/s/0c53bqw00qw2rmu/AtMyWorst.mp3?dl=0",
  },
  {
    title: "Bản Tình Ca Đầu Tiên",
    link: "https://dl.dropbox.com/s/1detj1wckrt2ye5/BanTinhCaDauTien.mp3?dl=0",
  },
  {
    title: "Beatiful In White",
    link: "https://dl.dropbox.com/s/ko7aetiimx3vvfk/beautifulInWhite.mp3?dl=0",
  },
  {
    title: "Blank",
    link: "https://dl.dropbox.com/s/me6jlcxp3i46wwf/Blank.mp3?dl=0",
  },
  {
    title: "Bỏ Em Vào Balo",
    link: "https://dl.dropbox.com/s/x4uwfjqfsg46lep/BoEmVaoBalo.mp3?dl=0",
  },
  {
    title: "Cho Tôi Tình Yêu",
    link: "https://dl.dropbox.com/s/m0zz057i578abmi/aChoToiTinhYeu.mp3?dl=0",
  },
  {
    title: "Counting Stars",
    link: "https://dl.dropbox.com/s/qbx60eea3g4r0ri/CountingStars.mp3?dl=0",
  },
  {
    title: "Có Hẹn Với Thanh Xuân",
    link: "https://dl.dropbox.com/s/9j6spqgqvg1hsqe/CoHenVoiThanhXuan.mp3?dl=0",
  },
  {
    title: "Em Đây Này",
    link: "https://dl.dropbox.com/s/7a1mp6ao6cvceta/aEmDayNay.mp3?dl=0",
  },
  {
    title: "Em Đồng Ý",
    link: "https://dl.dropbox.com/s/tvcgqzgdne603fn/EmDongY.mp3?dl=0",
  },
  {
    title: "Everytime We Touch",
    link: "https://dl.dropbox.com/s/x6mktsot8rbaatx/EverytimeWeTouch.mp3?dl=0",
  },
  {
    title: "Girls Like You",
    link: "https://dl.dropbox.com/s/0k98n8mxmuou9mo/GirlsLikeYou.mp3?dl=0",
  },
  {
    title: "Happy",
    link: "https://dl.dropbox.com/s/9ta4fbg3nkyaibb/Happy.mp3?dl=0",
  },
  {
    title: "Hạnh Phúc Cuối Cùng",
    link: "https://dl.dropbox.com/s/trmfafnisr1qtq2/HanhPhucCuoiCung.mp3?dl=0",
  },
  {
    title: "Heroes Tonight",
    link: "https://dl.dropbox.com/s/ntu8nbgefws4beb/HeroesTonight.mp3?dl=0",
  },
  {
    title: "Hơn Cả Mây Trời",
    link: "https://dl.dropbox.com/s/zkvmy4dk6zrj2k1/aHonCaMayTroi.mp3?dl=0",
  },
  {
    title: "I Do",
    link: "https://dl.dropbox.com/s/pwrzeijlzvpe03h/iDo.mp3?dl=0",
  },
  {
    title: "Invincible",
    link: "https://dl.dropbox.com/s/9zz9b0sa98t4djw/Invincible.mp3?dl=0",
  },
  {
    title: "Kẻ Theo Đuổi Ánh Sáng",
    link: "https://dl.dropbox.com/s/23jqvgapvnzg67x/KeTheoDuoiAnhSang.mp3?dl=0",
  },
  {
    title: "Không Cần Phải Hứa Đâu Em",
    link: "https://dl.dropbox.com/s/sdapnwgcr5y69w5/aKhongCanPhaiHuaDauEm.mp3?dl=0",
  },
  {
    title: "Là Anh Đây",
    link: "https://dl.dropbox.com/s/9p4mqhzqo85yead/aLaAnhDay.mp3?dl=0",
  },
  {
    title: "Love Me Like You Do",
    link: "https://dl.dropbox.com/s/zll96zh5ddkdez2/LoveMeLikeYouDo.mp3?dl=0",
  },
  {
    title: "Mặt Mộc",
    link: "https://dl.dropbox.com/s/x5vxqy4rf7r8d8b/MatMoc.mp3?dl=0",
  },
  {
    title: "Mortals",
    link: "https://dl.dropbox.com/s/z2u867re57xlx6p/Mortals.mp3?dl=0",
  },
  {
    title: "Mùa Yêu Đầu",
    link: "https://dl.dropbox.com/s/o07c2vmsagxuwu6/aMuaYeuDau.mp3?dl=0",
  },
  {
    title: "My Heart",
    link: "https://dl.dropbox.com/s/rer1ix5oc1scd2a/My%20Heart.mp3?dl=0",
  },
  {
    title: "My Love",
    link: "https://dl.dropbox.com/s/209w1q9q2o8ym0l/MyLove.mp3?dl=0",
  },
  {
    title: "Ngày Nắng Lên",
    link: "https://dl.dropbox.com/s/mogsjg0sqelj28k/aNgayNangLen.mp3?dl=0",
  },
  {
    title: "On & On",
    link: "https://dl.dropbox.com/s/of5zasv3uilzavb/On%26On.mp3?dl=0",
  },
  {
    title: "Perfect",
    link: "https://dl.dropbox.com/s/vdqbabdog40kxhz/Perfect.mp3?dl=0",
  },
  {
    title: "Proud Of You",
    link: "https://dl.dropbox.com/s/jqf6bh8un4xjgme/ProudOfYou.mp3?dl=0",
  },
  {
    title: "See You Again",
    link: "https://dl.dropbox.com/s/fwt5s82b9deo3w3/SeeYouAgain.mp3?dl=0",
  },
  {
    title: "Sẽ Mãi Một Tình Yêu",
    link: "https://dl.dropbox.com/s/vl17y5zuvlvwnlj/SeMaiMotTinhYeu.mp3?dl=0",
  },
  {
    title: "Shape Of You",
    link: "https://dl.dropbox.com/s/o9qtdy20t86zbx4/ShapeOfYou.mp3?dl=0",
  },
  {
    title: "Shine",
    link: "https://dl.dropbox.com/s/nsmqfcef34fzut0/Shine.mp3?dl=0",
  },
  {
    title: "Sky High",
    link: "https://dl.dropbox.com/s/pami722can8pbcu/Sky%20High.mp3?dl=0",
  },
  {
    title: "Sugar",
    link: "https://dl.dropbox.com/s/duxdvzy7nte7k4u/Sugar.mp3?dl=0",
  },
  {
    title: "Suýt Nữa Thì",
    link: "https://dl.dropbox.com/s/wvw9gcbn38pb1c0/SuytNuaThi.mp3?dl=0",
  },
  {
    title: "Symbolism",
    link: "https://dl.dropbox.com/s/0mfww3641k3ngqk/Symbolism.mp3?dl=0",
  },
  {
    title: "Tình Yêu Màu Hồng",
    link: "https://dl.dropbox.com/s/dl5unxogrkm7ah9/TinhYeuMauHong.mp3?dl=0",
  },
  {
    title: "Tình Yêu Trong Mơ",
    link: "https://dl.dropbox.com/s/cioeknqrikyen5y/aTinhYeuTrongMo.mp3?dl=0",
  },
  {
    title: "Until You",
    link: "https://dl.dropbox.com/s/tsgchato704iu0d/UntilYou.mp3?dl=0",
  },
  {
    title: "Uptown Funk",
    link: "https://dl.dropbox.com/s/z0h7dgjxxja3soc/UptownFunk.mp3?dl=0",
  },
  {
    title: "Why Not Me",
    link: "https://dl.dropbox.com/s/nsem7aldapcz5fs/WhyNotMe.mp3?dl=0",
  },
  {
    title: "Why We Lose",
    link: "https://dl.dropbox.com/s/0tsfhibbqvyfoc6/Why%20We%20Lose.mp3?dl=0",
  },
  {
    title: "Yêu Là Chờ",
    link: "https://dl.dropbox.com/s/s7nvmq5jo6s73xg/aYeuLaCho.mp3?dl=0",
  },
];

var totalSong = music.length;

var playOrPause = document.querySelector("#play-or-pause");
var backward = document.querySelector("#backward");
var forward = document.querySelector("#forward");
var repeat = document.querySelector("#repeat");
var shuffle = document.querySelector("#shuffle");
var isRepeat = false;
var isShuffle = false;
var titleMusicCtrl = document.querySelector(".title-music");

var audio = document.getElementById("audio");
var random = Math.floor(Math.random() * totalSong);
audio.setAttribute("src", `${music[random].link}`);
var playOrPauseBtn = playOrPause.querySelector("i");
titleMusicCtrl.innerHTML = music[random].title + " (0:00/0:00)";

// Click nút pause hoặc play
playOrPause.onclick = function () {
  var liTitle = document.querySelectorAll(".ul-list-music li");
  liTitle[random].classList.add("opening-music");

  if (playOrPauseBtn.classList.contains("fa-play")) {
    audio.play();
    playOrPauseBtn.classList.remove("fa-play");
    playOrPauseBtn.classList.add("fa-pause");
  } else {
    audio.pause();
    playOrPauseBtn.classList.remove("fa-pause");
    playOrPauseBtn.classList.add("fa-play");
  }
};

// Click nút bài trước
backward.onclick = function () {
  var liTitle = document.querySelectorAll(".ul-list-music li");

  if (random == 0) {
    random = totalSong - 1;
    liTitle[random].classList.add("opening-music");
    listMusicElement.classList.add("show-list-music");
    setTimeout(function () {
      liTitle[random].scrollIntoView({ behavior: "smooth", block: "center" });
    }, 300);
    liTitle[0].classList.remove("opening-music");
    liTitle[0].style.background = "#000";
  } else {
    random--;
    liTitle[random].classList.add("opening-music");
    listMusicElement.classList.add("show-list-music");
    setTimeout(function () {
      liTitle[random].scrollIntoView({ behavior: "smooth", block: "center" });
    }, 300);
    liTitle[random + 1].classList.remove("opening-music");
    liTitle[random + 1].style.background = "#000";
  }
  titleMusicCtrl.innerHTML = music[random].title + " (0:00/0:00)";
  audio.setAttribute("src", `${music[random].link}`);
  playOrPauseBtn.classList.remove("fa-play");
  playOrPauseBtn.classList.add("fa-pause");
  audio.play();
};

// Click nút bài tiếp theo
forward.onclick = function () {
  nextMusic();
};

// Click nút repeat
repeat.onclick = function () {
  isRepeat = !isRepeat;
  if (isRepeat) {
    repeat.classList.add("active");
  } else {
    repeat.classList.remove("active");
  }
};

// Click nút shuffle
shuffle.onclick = function () {
  isShuffle = !isShuffle;
  if (isShuffle) {
    shuffle.classList.add("active");
  } else {
    shuffle.classList.remove("active");
  }
};

// Tự chuyển bài hát khi phát xong bài trước
audio.onended = function () {
  if (isRepeat) {
    audio.play();
  } else {
    nextMusic();
  }
};

function nextMusic() {
  var liTitle = document.querySelectorAll(".ul-list-music li");

  if (isShuffle) {
    var newRandom;
    do {
      newRandom = Math.floor(Math.random() * totalSong);
    } while (newRandom === random - 1);
    liTitle[random].classList.remove("opening-music");
    liTitle[random].style.background = "#000";
    liTitle[totalSong - 1].classList.remove("opening-music");
    liTitle[totalSong - 1].style.background = "#000";

    random = newRandom;
  }

  if (random == totalSong - 1) {
    random = 0;
    liTitle[random].classList.add("opening-music");
    listMusicElement.classList.add("show-list-music");
    setTimeout(function () {
      liTitle[random].scrollIntoView({ behavior: "smooth", block: "center" });
    }, 300);
    liTitle[totalSong - 1].classList.remove("opening-music");
    liTitle[totalSong - 1].style.background = "#000";
  } else {
    random++;
    liTitle[random].classList.add("opening-music");
    listMusicElement.classList.add("show-list-music");
    setTimeout(function () {
      liTitle[random].scrollIntoView({ behavior: "smooth", block: "center" });
    }, 300);
    liTitle[random - 1].classList.remove("opening-music");
    liTitle[random - 1].style.background = "#000";
  }
  titleMusicCtrl.innerHTML = music[random].title + " (0:00/0:00)";
  audio.setAttribute("src", `${music[random].link}`);
  playOrPauseBtn.classList.remove("fa-play");
  playOrPauseBtn.classList.add("fa-pause");
  audio.play();
}

// Click nút mở danh sách bài hát
var dropdownMusic = document.querySelector(".dropdown-music");
var listMusicElement = document.querySelector(".list-music");

dropdownMusic.onclick = function () {
  if (listMusicElement.classList.contains("show-list-music")) {
    listMusicElement.classList.remove("show-list-music");
  } else {
    listMusicElement.classList.add("show-list-music");
    var musicOpening = document.querySelector(
      ".ul-list-music li.opening-music"
    );
    setTimeout(function () {
      musicOpening.scrollIntoView({ behavior: "smooth", block: "center" });
    }, 300);
  }
};

// Hiện danh sách bài hát
var ulListMusic = document.querySelector(".ul-list-music");
for (var i = 0; i < totalSong; i++) {
  var li = document.createElement("li");
  li.innerText = music[i].title;
  ulListMusic.appendChild(li);
}

// Click vào bài hát trong danh sách để phát / click vào bài đang phát để tua
var ulListMusic = document.querySelector(".ul-list-music");
ulListMusic.onclick = function (event) {
  var liTitle = document.querySelectorAll(".ul-list-music li");
  var target = event.target.innerText;
  var index = music.findIndex((x) => x.title === target);
  if (index !== random) {
    audio.setAttribute("src", `${music[index].link}`);
    titleMusicCtrl.innerHTML = music[index].title + " (0:00/0:00)";
    liTitle[index].classList.add("opening-music");
    liTitle[random].classList.remove("opening-music");
    liTitle[random].style.background = "#000";
    random = index;
    playOrPauseBtn.classList.remove("fa-play");
    playOrPauseBtn.classList.add("fa-pause");
    audio.play();
  } else {
    audio.currentTime =
      (event.offsetX / event.target.offsetWidth) * audio.duration;
  }
};

// Click bật tắt âm lượng
var muteMusic = document.querySelector(".mute-music");
var iconMute = document.querySelector(".mute-music i");

muteMusic.onclick = function () {
  if (iconMute.classList.contains("fa-volume-xmark")) {
    audio.muted = true;
    iconMute.classList.remove("fa-volume-xmark");
    iconMute.classList.add("fa-volume-high");
  } else {
    audio.muted = false;
    iconMute.classList.remove("fa-volume-high");
    iconMute.classList.add("fa-volume-xmark");
  }
};

audio.addEventListener("timeupdate", function () {
  var musicOpening = document.querySelector(".ul-list-music li.opening-music");

  var percent = (audio.currentTime / audio.duration) * 100;
  musicOpening.style.background = `linear-gradient(to right, rgba(0, 150, 136) ${percent}%, white 0%)`;
  if (audio.duration) {
    var minutes = Math.floor(audio.duration / 60);
    var seconds = Math.floor(audio.duration - minutes * 60);
    if (seconds < 10) {
      seconds = "0" + seconds;
    }
    var currentMinutes = Math.floor(audio.currentTime / 60);
    var currentSeconds = Math.floor(audio.currentTime % 60);
    if (currentSeconds < 10) {
      currentSeconds = "0" + currentSeconds;
    }
    titleMusicCtrl.innerHTML = `${music[random].title} (${currentMinutes}:${currentSeconds}/${minutes}:${seconds})`;
  }
});
